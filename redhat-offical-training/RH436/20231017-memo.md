# day 1

__이름:__ 최국현<br/>
__이메일__: tang@linux.com<br/>


메모주소
---
https://github.com/tangt64/training_memos/
>redhat-offical-training
>/RH436/20231017-memo.md

https://github.com/tangt64/training_memos/
>/opensource-101
>/pacemaker-101/

랩 및 사이트 접속 주소
---
https://rol.redhat.com

__"리소스"__ --> __"e-book다운로드"__ 가능 합니다.

가입하신 __아이디/비번__ 으로 접근하시면 됩니다.


pcs명령어 자동완성이 안되면

```bash
completion -r -p
source /etc/bashrc

ls -l /etc/bash_completion.d/
ls -l /usr/share/bash-completion/completions/
```


```bash
>getenfroce 
>setenforce 0

dnf install pcs fence-agents-all -y 
echo redhat | passwd --stdin hacluster 
systemctl enable --now pcsd 

firewall-cmd --get-services
firewall-cmd --add-service high-availabilty --permanent
firewall-cmd --reload(opt1)

firewall-cmd --add-service high-availabilty
firewall-cmd --runtime-to-permanent (opt2)

>systemctl stop firewall 

pcs host auth -u hacluster -p redhat node1 node2 node3
pcs cluster create --enable --start node1 node2 node3
pcs status
```

레드햇 참고 링크
---
[레드햇 솔루션 two_node](https://access.redhat.com/solutions/1294873)
[레드햇 솔루션 two_node옵션 설명](https://access.redhat.com/solutions/1293543)

```bash
pcs cluster stop --all
vi /etc/corosync/corosync.conf
> two_node: 1
> wait_for_all: 1
> last_man_standing: 1
> auto_tie_breaker: 1
> auto_tie_breaker_node: 1 3 5
>> auto_tie_breaker_node: lowest
>> auto_tie_breaker_node: highest
pcs cluster sync
pcs clustart start --all
```

# day 2

pacemaker: (p)a(c)e(m)a(k)er

STONITH
---
```
  +-----------+
  | pacemaker |
  +-----------+
    |       |                 .---> resource
    |       |                /
  pcsd  pacemaker --> agent <
    |       [pcmk]           \
    |                         `---> stonith
    v
     # pcs sync(corosync)
       agent
```

IPMI(drac,ILO)
---
```
     VirtualBMC <--> OpenBMC
         |              |
         |            vender
         |
       IPMI(poweroff, reboot)
       /  \
      /    \
    drac   ILO
```



```bash
/var/lib/pacemaker/cib

cibadmin --query --local
cibadmin --replace --xml-file <XML_FILE>

crm_standby -N nodea.private.example.com
crm_resource --list-agents ocf
             -N nodea.private.example.com
crm_report -f "2023-10-17 00:00:00" /tmp/report
           -f "2023-10-17 00:00:00" -n nodec /tmp/report-nodec
           -f "2023-10-17 00:00:00" --sos-mode /tmp/report-nodec-sosreport
crm_error -l

crm_simulate
```

># day 3
>
># day 4