# DAY 1

## 교육 및 강사 소개

최국현, tang@linux.com

## 점심시간/쉬는시간

- 쉬는시간: 15분 정도(40~45분정도)
- 점심시간: 12:00 ~ 13:20분

## 레드햇 계정 정보

https://rol.redhat.com

- root/redhat
- student/student, 이 계정에서 랩 진행 및 실습

교재는 __ebook, online__ 둘 다 사용이 가능 합니다. 가급적이면 ebook(PDF)는 __영문, 한글__ 둘 다 내려받기 부탁 드립니다.

온라인 교재는 메모 기능이 있으나, RHLS를 사용하시지 않는 경우, 다시 사용하는 경우가 없기 때문에, 메모가 필요하시면, PDF기반으로 메모하시길 권장 합니다.

__RH294__ 쥬피터 랩 사용이 가능 합니다. 굳이, VNC를 사용하시지 않으셔도 됩니다.


메모링크
---
https://github.com/tangt64/training_memos/
>/redhat
>/RH294

[메모 링크](https://github.com/tangt64/training_memos/tree/main/redhat/RH294)


판서링크
---
[MS화이트 보드](https://wbd.ms/share/v2/aHR0cHM6Ly93aGl0ZWJvYXJkLm1pY3Jvc29mdC5jb20vYXBpL3YxLjAvd2hpdGVib2FyZHMvcmVkZWVtLzg4MWJmMDg3MzUxZDQxNWVhYjg0ZDQ2NjUwMTA2OWJiX0JCQTcxNzYyLTEyRTAtNDJFMS1CMzI0LTVCMTMxRjQyNEUzRF9mZmE4YWIzMy1lMjk3LTQ4ODgtOTU5MS02MWQyNjY0ZjQ2NzY=)

## 앤서블

리눅스에서 많이 사용하였던 자동화 도구.

- puppet lab(ruby)
- bash script(bash)
- ansible
- salt 

1. puppet경우에는 진입 장벽이 높음.
2. 레드햇도 puppet를 많이 사용함(오픈스택)
3. RHOSP(director, puppet, ansible + script)
4. OpenStack Kolla(ansible)

앤서블 자원 구분
---
1. 앤서블이 실행되는 노드는 __"컨트롤 노드"__ 라고 호칭.
2. 앤서블이 관리하는 노드는 __"매니지드 노드"__ 라고 호칭.




## Code as a infra

__쉘 스크립트:__ 코드기반으로 인프라 자동화 관리. "chroot"
>설정파일 배포 혹은 백업수준
>코드가 사람마다 다르고 표준화가 안되어 있음
>코딩 표준화 문제

__파이썬/루비:__ 코드기반으로 인프라 자동화 관리.
>운영자동화를 슬슬도입.
>CS기반으로 파일 배포 및 네트워크 설정 혹은 애플리케이션 구성
>결론적으로 이쪽도 코딩표준화 문제. 네트워크 영역에서 많이 사용하는 방식.

__앤서블:__ 파이썬에서 함수 표준화를 위해서 나온도구. 함수가 모듈형태로 변경이 되면서, 표준화를 이루어짐. 진입장벽이 매우 낮음. 네트워크 장비도 지원. ssh/telnet.

__퍼핏:__ 루비 기반으로 함수 표준화를 하였으나, DOM형식의 코딩을 지원. 자유도는 높지만, 진입 장벽이 좀 있고, 코드 표준화가 좀 어려움. 

__테라폼:__ 고랭 기반으로, 함수 표준화를 하였으나, DOM형식으로 코딩을 지원...

## 오픈소스 표준 설정안

1. TOML: 설정파일
2. YAML: 인프라자원
3. JSON: 개발자원

YAML 단점중 하나는, 사용하는 도구별로 렌더링 방식이 다름. 
- YAML for Heat
- YAML for Ansible
- YAML for Kubernetes

## 앤서블 버전 및 프로그램 구분

__앤서블 코어:__ 핵심 명령어 및 라이브러리+플러그인

__앤서블 프로젝트:__ 핵심 도구 + 확장 라이브러리

앤서블은 기본적으로 __"탑/다운"__ 형식으로 코드 작성. 

앤서블은 __네트워크/운영체제/배포__ 기능 위주.

앤서블은 대화형 기능을 제공하지 않음.

앤서블은 사용전에 모든 프로세스에 대해서 정의가 완료가 되어 있어야 됨. 일반적으로 모든 값들은 "상수"로 정의가 되어 있어야 됨. 

1. 앤서블 PIP

일반적으로 파이썬 PIP를 통해서 설치가 가능. 레드햇은 특히 RHEL/Centos-Stream에서는 이 방식으로 사용은 권장하지 않음.

2. 앤서블 RPM

RHEL경우에는 모든 RPM를 제공 합니다. 하지만, 레드햇 계열은 모든 앤서블 패키지를 RPM기반으로 제공 안하는 경우가 있음. 레드햇 계열의 호환 배포판 경우에는 앤서블 패키지를 전부 지원하지는 않음. 버전도 조금씩 다름.

3. 앤서블 코어

핵심 기능만 있는 패키지. 실제로는 거의 사용이 어렵다고 보면 됨. 

- CLI tools such as __ansible-playbook__, __ansible-doc__, __ansible__. and others for driving and interacting with automation.
- The Ansible language that uses YAML to create a set of rules for developing Ansible Playbooks and includes functions such as conditionals, blocks, includes, loops, and other Ansible imperatives.
- An architectural __framework__ that allows extensions through Ansible __collections__.

4. ansible-project

__"ansible core"__ 에 추가적인 __콜렉션(collection)__ 기능을 추가한 구성.

5. ansible-navigator/lint/runner

앤서블의 제일 단점중 하나가 __"파이썬 패키지"__ 의존성 문제. 앤서블이 바이너리로 보이지만, 실제로는 로더(loader)기능만 있기 때문에, 파이썬 라이브러리에 의존함. 

이 문제를 해결하기 위해서 __"ansible-navigator"__ 를 만들어서 배포. 컨테이너 기반으로 동작(podman). 단점은, 생각보다 관리 및 사용이 조금 복잡함. 

__"ansible-runner"__ 다중 노드에서 앤서블 플레이북 실행. 한 개 이상의 컨트롤 노드에서 플레이북 실행. 

## 앤서블 플레이북

```bash

# ansible-playbook  [ control node ]
      \
       \
        `---> [ managed node ]
                                         .---> CRC체크가 구림..
                                        /
                                       /
ansible-playbook --> memory[YAML] --> lint --> compile[binary code] 
                      - python ansible module 
                      - data(inventory, variables, facts)

ansible-control-node
- ansible-playbook          (single control node)
- ansible-playbook + runner (multi control node)


# ansible <MODULE>

# ansible-playbook <PLAYBOOK>

 +---| playbook |---+
 |                  |
 |   +------+       |
 |   | task |       |
 |   +------+       |
 |     +--------+   |
 |     | module |   |
 |     +--------+   |
 |                  |
 +------------------+
```


# DAY 2

# DAY 3

# DAY 4