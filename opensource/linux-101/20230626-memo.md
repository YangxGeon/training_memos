# DAY1

## 소개

강사
---
- 최국현
- tang@linux.com

화이트 보드
---
[링크](https://wbd.ms/share/v2/aHR0cHM6Ly93aGl0ZWJvYXJkLm1pY3Jvc29mdC5jb20vYXBpL3YxLjAvd2hpdGVib2FyZHMvcmVkZWVtLzA3OTMxMTVjMDRkMjQwMjFhMjU3YWRjYzc1MDA4OWRkX0JCQTcxNzYyLTEyRTAtNDJFMS1CMzI0LTVCMTMxRjQyNEUzRF8xYzE2Nzc1Mi01MDk0LTRiOWEtYTU0MS0zOGNhMWFlMjhjMzA=)

강의시간
---

__시작:__ 오전 08시 30분 
__점심:__ 오후 12시 00분 ~ 오후 01시 00분
__종료:__ 오후 04시 30분

강의 자료
---

https://github.com/tangt64/training_memos
>opensource/linux-101/20230626-memo.md
>
>여기에서 PDF 및 메모파일 확인 및 내려받기 가능 합니다.


MAC VZ-Machine(For VM)
---
https://github.com/Code-Hex/vz
>google keyword: applie vz machine


## 표준화 부분

__INI/TOML:__ 설정 파일은 앞으로 INI/TOML형태로 구성.
__YAML:__ 인프라 코드(aka 자동화)는 YAML기반으로 구성.
__JSON:__ 개발용 및 데이터 교환 시 사용.

FHS에서 현재는 LSB(ISO/IEC International Standard 23360호환)라는 사양으로 변경.

## 리눅스 주요 기능 확인

질문사항
---
1. 회사에서 컨테이너 시스템 사용중 이신지?
2. 사용중이라면 어떤 기반으로 사용중 이신지?
3. 오픈소스 기반으로 컨테이너 및 가상화 시스템 구성 혹은 예정이신지?

### 컨테이너 영역

docker가 거의 표준. 어떠한 계기로...

docker vs Redhat/SuSE/Google/IBM(CRI/OCI)
          ----------------------
~~docker: docker CE/EE~~

1. podman --> docker
2. CRI-O  --> docker(kubernetes)
3. kubernetes orche
4. docker search --> skopeo(이미지 검색 및 백업 복사)
5. docker build  --> buildah(이미지 자동빌드)

#### 어떤 런타임을 써야하나?

1. cri-docker
2. containerd(low manager)
3. cri-o(표준,빠르고 안정적)

Redhat에서는...

CRI-O런타임을 OpenShift에서만 제공하고, 커뮤니티 저장소에서 제공하지 않음.

- https://buildah.io/
- https://podman.io/
- https://github.com/containers/skopeo

### 가상화 영역

- kube-virt(in Kubernetes)
    + https://kubevirt.io/
- OpenStack
    + https://openstack.org
- ovirt(RHV as Redhat)
    + https://www.ovirt.org/

### 표준화 영역
- Linux Standard Base(LSB)
- Container 
    + CRI(Container Runtime Interface)
    + OCI(https://opencontainers.org/)
    + CNCF(https://www.cncf.io/)
    + CSI(https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/)
    + CNI(https://github.com/containernetworking/cni)
- Virtualization
    + libvirtd(https://libvirt.org/manpages/libvirtd.html)

```bash
## 네트워크 영역
# 더 이상 네트워크 스크립트로 지원하지 않음
systemctl status NetworkManager
nmcli con show
nmcli dev 
ip, ss, ip route


## 컨테이너 영역
# 개발 및 테스트 용도로 사용하는 표준 컨테이너 도구는
# buildah/podman/skopeo

dnf install podman 

## 리눅스 컨테이너 시스템은 네임스페이스 기반으로 동작
lsns
ip netns

## 가상머신 영역
dnf install libvirt -y
systemctl start libvirtd
systemctl status libvirtd
lsmod | grep kvm

## dbus 영역
systemctl status dbus-broker

## 모듈 영역
lsmod

## 커널 영역
# https://docs.rockylinux.org/guides/custom-linux-kernel/
ls /boot/
ls -l /usr/src/
dnf download --source kernel
```

## 모듈 확장 및 추가 설치를 원하는 경우

저장소를 추가 구성
```bash
dnf install epel-release

# https://elrepo.org/tiki/HomePage
rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
yum install https://www.elrepo.org/elrepo-release-9.el9.elrepo.noarch.rpm
```

zsh(https://ohmyz.sh/#install)
```bash
dnf install git -y
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
```

### tmux 설정


```bash
killall -9 dnf
dnf install epel-release -y
dnf install tmux -y
nano ~/.tmux.conf
> setw -g mouse on   ## ctrl+o: save, ctrl+x: exit

tmux source-file ~/.tmux.conf
tmux

```

|: Pipe

```bash
ps | sort 
```

### systemd

```bash

poweroff/halt/shutdown

reboot

runlevel == target
--------    ------
이전        현재
1/2/3/..    multi-user, graphical
```

#### 명령어 간단 정리

dnf: 패키지 설치관리자. yum명령어를 이전에 사용. 
```bash
dnf install zsh tcsh
dnf groupinstall "Server with GUI" -y
dnf install tmux
```
chsh: 사용자 쉘 변경 명령어. 'chsh -u <USERNAME> -s <SHELL>'. 'chsh -l', 'cat /etc/shell'
type: 명령어 형식
tmux: 화면 분활 관리 프로그램 + 세션 관리자
systemctl: systemd블록 관리자 명령어. 서비스 및 기타 유닛을 관리.
service: 레거시 처리
runlevel: 레거시 처리
telinit: 레거시 처리
init: 레거시 처리
poweroff/reboot/shutdown: systemd로 통합. 흔적만 남아 있음.
/bin,/sbin,/lib: 현재 흔적만 남아 있고, /usr/로 통합이 완료.



내부 명령어(builtin command, internal)
---
type 명령어로 내부 및 외부 명령어 구별 및 확인이 가능

외부 명령어
~~시스템 명령어~~

연습문제
---

가상머신을 추가로 한대 더 구축 후 다음과 같은 조건으로 OS를 구성한다. 추가하는 서버의 이름은 "nodeb"라는 이름으로 생성한다. **기존 가상머신은 수정하지 말고 그대로 나두세요!**

1. OS설치시 패키지는 최소 설치를 하되, 가상머신 에이전트는 꼭 설치한다.
2. 부팅 후 부팅 모드를 graphical.target로 변경한다. 기본값은 일반적으로 multi-user.target으로 되어있음.
  - systemctl get-default
  - systemctl set-default
  - systemctl isolate <TARGET>      ## 바로 변경. init 3, init 5 
3. dnf명령어로 tmux패키지를 설치한다.
4. epel저장소를 설치 및 구성한다.
  - dnf install epel-release -y
5. 사용자 쉘을 zsh로 변경한다.
  - root쉘을 zsh으로 변경한다.
  - dnf install zsh -y
  - chsh -s /sbin/zsh


### /etc/hosts, /etc/hostname


```bash
ping yahoo.com --> /etc/hosts --> /etc/resolve.conf --> external DNS
                   ----------
                   A Recode

vi /etc/hostname                          ## 권장하지 않음
hostnamectl                               ## dbus  
hostnamectl set-hostname nodea.example.com
ip s a eth0 | grep inet
>[IP_ADDRESS]

vi /etc/hosts             ## nodea/b에 양쪽에 적용
>172.30.164.103 nodea.example.com nodea
>172.30.170.247 nodeb.example.com nodeb
ping nodea -c3
ping nodeb -c3

timedatectl
timedatectl list-timezones                    ## tzselect

locale
## LC_ALL: 화폐, 시간, 주소 + 메세지
## LANG: 시스템 전역으로 특정 언어로 모든 프로그램들이 영향을 받음
localectl set-local ja_JP.utf8
locale -a
localectl list-locales 
```


# DAY2

# DAY3

# DAY4