# DAY 1

- 이름: 최국현
- 메일: tang@linux.com

__쉬는시간:__ 15분

__점심시간:__ 12시부터 01시 20분까지.

메모파일 및 교재
---
https://github.com/tangt64/training_memos/
>/opensource-101/kubernetes-101/20240213-memo.md


화이트보드
---
https://wbd.ms/share/v2/aHR0cHM6Ly93aGl0ZWJvYXJkLm1pY3Jvc29mdC5jb20vYXBpL3YxLjAvd2hpdGVib2FyZHMvcmVkZWVtLzdkNGM4ZTBiMTJhZDRhNTRhYTNkMGRmNWI0N2NkNTY5X0JCQTcxNzYyLTEyRTAtNDJFMS1CMzI0LTVCMTMxRjQyNEUzRF81NzVjMDQ0Mi1hNmU5LTRmNGYtYjY2MS1jNzg0NzcyMGU1ODg=


연습 혹은 실무적 수준으로 랩 구성
---

kubeadm명령어 기반으로 설치
>공식 설치 도구
>강의 진행은 __kubeadm__ 기반으로 진행

minikube/kind는 사용하지 말기.
>AIO/SNO
>master x 1, worker x 2 --> 5EA
>master x 3, L/B Server(VIP), Pacemaker  

자동화 도구
>kubespray(ansible)
>terraform

플랫폼 조합(?)
---
- OpenStack + Kubernetes
- LDAP/FreeIPA(https://www.freeipa.org/)
- Operator(https://sdk.operatorframework.io/)


소프트웨어
---
1. crio(containerd)
2. container-tools(표준 컨테이너 도구)
3. containerd(https://github.com/Mirantis/cri-dockerd) 권장
4. CentOS/Rocky/RHEL/Debian(ubuntu)
5. calico


랩 사양(PoC)
---
- CPU: I5이상에, 8core권장
- MEM: 32GiB이상
- DISK: 1TB, NvME/SSD
- NIC: 1G~10G(baremetal 3G이상)
- OS: Windows 11 Pro + Hyver-V, Rocky Linux 9, CentOS-Stream


## 설치 준비


- [공식 설치 문서](https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/)
- [OSTREE](https://github.com/ostreedev/ostree)
- [CRIO RUNTIME](https://cri-o.io/)


```bash
dnf search hyper
>hyperv-daemons.x86_64 : Hyper-V daemons suite
>hyperv-daemons-license.noarch : License of the Hyper-V daemons suite
>hyperv-tools.noarch : Tools for Hyper-V guests
>hypervfcopyd.x86_64 : Hyper-V FCOPY daemon
>hypervkvpd.x86_64 : Hyper-V key value pair (KVP) daemon
>hypervvssd.x86_64 : Hyper-V VSS daemon

dnf install -y hyperv-tools hypervfcopyd hypervkvpd hypervvssd hyperv-daemons
reboot

dnf search ostree 						## rhcos, fedora coreos
										## ostree, RPM기반


curl -o /etc/yum.repos.d/stable.repo https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/CentOS_9_Stream/devel:kubic:libcontainers:stable.repo

curl -o /etc/yum.repos.d/crio.repo https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable:/cri-o:/1.24:/1.24.6/CentOS_8/devel:kubic:libcontainers:stable:cri-o:1.24:1.24.6.repo

dnf repolist
dnf search cri-o
dnf install -y cri-o

lsns									## 네임스페이스 조회
systemd-cgls							## cgroup 조회


#
# https://v1-27.docs.kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/
# 설치는 버전 1.27로 진행(추후 업그레이드 테스트)
# 

cat <<EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://pkgs.k8s.io/core:/stable:/v1.27/rpm/
enabled=1
gpgcheck=1
gpgkey=https://pkgs.k8s.io/core:/stable:/v1.27/rpm/repodata/repomd.xml.key
exclude=kubelet kubeadm kubectl cri-tools kubernetes-cni
EOF

dnf install -y kubelet kubeadm kubectl --disableexcludes=kubernetes

systemctl enable --now crio
systemctl enable --now kubelet

```


# DAY 2

# DAY 3

# DAY 4